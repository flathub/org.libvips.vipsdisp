{
    "app-id" : "org.libvips.vipsdisp",
    "runtime" : "org.gnome.Platform",
    "runtime-version" : "43",
    "sdk" : "org.gnome.Sdk",
    "command" : "vipsdisp",
    "finish-args" : [
        "--device=dri",
        "--share=ipc",
        "--socket=fallback-x11",
        "--socket=wayland",
        "--talk-name=org.gtk.vfs.*",
        "--filesystem=xdg-run/gvfsd",
        "--filesystem=home",
        "--filesystem=/mnt",
        "--filesystem=/srv"
    ],
    "cleanup" : [
        "/include",
        "/lib/girepository-1.0",
        "/lib/pkgconfig",
        "/lib/cmake",
        "/lib/openjpeg-*",
        "/lib/libhdf5.settings",
        "/man",
        "/share/aclocal",
        "/share/doc",
        "/share/gir-1.0",
        "/share/gtk-doc",
        "/share/man",
        "/share/pkgconfig",
        "/share/aclocal*",
        "/share/autoconf*",
        "/share/automake*",
        "/share/info",
        "/share/thumbnailers",
        "/share/USING_HDF5_CMake.txt",
        "/share/COPYING",
        "/share/RELEASE.txt",
        "/share/cmake",
        "/bin/a*",
        "/bin/b*",
        "/bin/c*",
        "/bin/d*",
        "/bin/e*",
        "/bin/f*",
        "/bin/g*",
        "/bin/h*",
        "/bin/i*",
        "/bin/l*",
        "/bin/m*",
        "/bin/o*",
        "/bin/p*",
        "/bin/r*",
        "/bin/s*",
        "/bin/t*",
        "/bin/x*",
        "/bin/vips",
        "/bin/vipsheader",
        "/bin/vipsedit",
        "/bin/vipsprofile",
        "/bin/vipsthumbnail",
        "/bin/jxlinfo",
        "*.la",
        "*.a"
    ],
    "modules" : [

        {
            "name" : "libjxl",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/libjxl/libjxl.git",
                    "tag" : "v0.7.0",
                    "commit" : "f95da131cf7c7ccd4da256356fde2fec1fa23bb5"
                }
            ]
        },

        {
            "name" : "openjpeg",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/uclouvain/openjpeg.git",
                    "tag" : "v2.5.0",
                    "commit" : "a5891555eb49ed7cc26b2901ea680acda136d811"
                }
            ]
        },

        {
            "name" : "libimagequant",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "build-options" : {
                "arch" : {
                    "aarch64" : {
                        "config-opts" : [
                            "-DBUILD_WITH_SSE=NO"
                        ]
                    }
                }
            },
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/ImageOptim/libimagequant.git",
                    "tag" : "2.15.1",
                    "commit" : "2cf79d535d86daeb9983e5d037fc544b4354f3b1"
                }
            ]
        },

        {
            "name" : "libspng",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/randy408/libspng.git",
                    "tag" : "v0.7.3",
                    "commit" : "bab9f94a1186f8fda234b4e1cb65e1b9a77049cc"
                }
            ]
        },

        {
            "name" : "libgsf",
            "builddir" : true,
            "buildsystem" : "autotools",
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/GNOME/libgsf.git",
                    "tag" : "LIBGSF_1_14_50",
                    "commit" : "3f6b8dc6f2ba395eeb0dc3c2ebc60c14105be3e1"
                }
            ]
        },

        {
            "name" : "poppler-data",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://poppler.freedesktop.org/poppler-data-0.4.11.tar.gz",

                    "sha256" : "2cec05cd1bb03af98a8b06a1e22f6e6e1a65b1e2f3816cb3069bb0874825f08c"
                }
            ]
        },

        {
            "name" : "poppler-glib",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "config-opts" : [
                    "-DENABLE_ZLIB=ON",
                    "-DENABLE_LIBTIFF=ON",
                    "-DENABLE_LIBPNG=ON",
                    "-DENABLE_GLIB=ON",
                    "-DENABLE_CMS='lcms2'",
                    "-DENABLE_LIBOPENJPEG='openjpeg2'",
                    "-DENABLE_DCTDECODER='libjpeg'",
                    "-DENABLE_SPLASH=OFF",
                    "-DENABLE_BOOST=OFF",
                    "-DENABLE_CPP=OFF"
            ],
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://poppler.freedesktop.org/poppler-22.12.0.tar.xz",

                    "sha256" : "d9aa9cacdfbd0f8e98fc2b3bb008e645597ed480685757c3e7bc74b4278d15c0"
                }
            ]
        },

        {
            "name" : "imath",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/AcademySoftwareFoundation/Imath.git",
                    "tag" : "v3.1.6",
                    "commit" : "7c6c5fd76edf0c71db1a5a14d66a04a7d2bf9c1f"
                }
            ]
        },

        {
            "name" : "openexr",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/AcademySoftwareFoundation/openexr.git",
                    "tag" : "v3.1.5",
                    "commit" : "420da6a57a3ecaeab481b993dd590eeec8fe0c52"
                }
            ]
        },

        {
            "name" : "openslide",
            "builddir" : true,
            "buildsystem" : "autotools",
            "rm-configure" : true,
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://github.com/openslide/openslide/releases/download/v3.4.1/openslide-3.4.1.tar.gz",
                    "sha256" : "fed08fab8a9b1ded95a34e196652291127ebe392c11f9bc13d26e760295a102d"
                },
                {
                    "type" : "patch",
                    "path" : "patches/openslide-3-fixes.patch"
                },
                {
                    "type" : "script",
                    "dest-filename" : "autogen.sh",
                    "commands" : [ 
                         "autoreconf --force --install"
                    ]
                }
            ]
        },

        {
            "name" : "hdf5",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "http://www.hdfgroup.org/ftp/HDF5/current/src/hdf5-1.10.5.tar.gz",
                    "sha256" : "6d4ce8bf902a97b050f6f491f4268634e252a63dadd6656a1a9be5b7b7726fa8"
                }
            ]
        },

        {
            "name" : "matio",
            "builddir" : true,
            "buildsystem" : "autotools",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "http://downloads.sourceforge.net/sourceforge/matio/matio-1.5.23.tar.gz",
                    "sha256" : "9f91eae661df46ea53c311a1b2dcff72051095b023c612d7cbfc09406c9f4d6e"
                }
            ]
        },

        {
            "name" : "cfitsio",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://heasarc.gsfc.nasa.gov/FTP/software/fitsio/c/cfitsio-4.2.0.tar.gz",
                    "sha256" : "eba53d1b3f6e345632bb09a7b752ec7ced3d63ec5153a848380f3880c5d61889"
                }
            ]
        },

        {
            "name" : "libde265",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://github.com/strukturag/libde265/releases/download/v1.0.9/libde265-1.0.9.tar.gz",
                    "sha256" : "29bc6b64bf658d81a4446a3f98e0e4636fd4fd3d971b072d440cef987d5439de"
                },
                {
                    "type" : "patch",
                    "path" : "patches/libde265-1-fixes.patch"
                }
            ]
        },

        {
            "name" : "libheif",
            "builddir" : true,
            "buildsystem" : "cmake-ninja",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://github.com/strukturag/libheif/releases/download/v1.14.0/libheif-1.14.0.tar.gz",
                    "sha256" : "9a2b969d827e162fa9eba582ebd0c9f6891f16e426ef608d089b1f24962295b5"
                }
            ]
        },

        {
            "name" : "cgif",
            "buildsystem" : "meson",
            "config-opts" : [
                "--buildtype=release"
            ],
            "builddir" : true,
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/dloebl/cgif.git",
                    "tag" : "V0.3.0"
                }
            ]
        },

        {
            "name" : "libvips",
            "builddir" : true,
            "buildsystem" : "meson",
            "config-opts" : [
                "--buildtype=release",
                "-Ddeprecated=false",
                "-Dmodules=disabled"
            ],
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/libvips/libvips.git",
                    "tag" : "v8.14.1"
                }
            ]
        },

        {
            "name" : "vipsdisp",
            "builddir" : true,
            "buildsystem" : "meson",
            "config-opts" : [
                "--buildtype=release"
            ],
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/jcupitt/vipsdisp.git",
                    "commit" : "d3e71dce18f7e53a403c3d30375e512964722cde"
                }
            ]
        }
    ]
}

